<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ç¬¬ä¸‰è®² åˆ†è¯å’Œç´¢å¼• | æ¨èç³»ç»Ÿå¼€å‘æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/nomoe/favicon.ico">
    <meta name="description" content="News Demo Doc">
    
    <link rel="preload" href="/nomoe/assets/css/0.styles.46c87d11.css" as="style"><link rel="preload" href="/nomoe/assets/js/app.b0634cdc.js" as="script"><link rel="preload" href="/nomoe/assets/js/2.e531c252.js" as="script"><link rel="preload" href="/nomoe/assets/js/17.da74545f.js" as="script"><link rel="prefetch" href="/nomoe/assets/js/10.f8c2e7ab.js"><link rel="prefetch" href="/nomoe/assets/js/11.a72faa70.js"><link rel="prefetch" href="/nomoe/assets/js/12.2932e2a5.js"><link rel="prefetch" href="/nomoe/assets/js/13.680ff2e4.js"><link rel="prefetch" href="/nomoe/assets/js/14.e1056133.js"><link rel="prefetch" href="/nomoe/assets/js/15.14c6f790.js"><link rel="prefetch" href="/nomoe/assets/js/16.feab6203.js"><link rel="prefetch" href="/nomoe/assets/js/18.dfbc94c1.js"><link rel="prefetch" href="/nomoe/assets/js/19.5e254fde.js"><link rel="prefetch" href="/nomoe/assets/js/20.f8be3a04.js"><link rel="prefetch" href="/nomoe/assets/js/21.83956418.js"><link rel="prefetch" href="/nomoe/assets/js/22.d0011416.js"><link rel="prefetch" href="/nomoe/assets/js/23.e1c4e5da.js"><link rel="prefetch" href="/nomoe/assets/js/24.52c6dafe.js"><link rel="prefetch" href="/nomoe/assets/js/25.544fbff6.js"><link rel="prefetch" href="/nomoe/assets/js/26.5fd376d5.js"><link rel="prefetch" href="/nomoe/assets/js/27.4a83da68.js"><link rel="prefetch" href="/nomoe/assets/js/3.b79a0801.js"><link rel="prefetch" href="/nomoe/assets/js/4.21c265ed.js"><link rel="prefetch" href="/nomoe/assets/js/5.67bfa7f8.js"><link rel="prefetch" href="/nomoe/assets/js/6.c01f87cc.js"><link rel="prefetch" href="/nomoe/assets/js/7.ea71c5c9.js"><link rel="prefetch" href="/nomoe/assets/js/8.f6d4234c.js"><link rel="prefetch" href="/nomoe/assets/js/9.906cc110.js">
    <link rel="stylesheet" href="/nomoe/assets/css/0.styles.46c87d11.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/nomoe/" class="home-link router-link-active"><img src="/nomoe/logo.gif" alt="æ¨èç³»ç»Ÿå¼€å‘æ–‡æ¡£" class="logo"> <span class="site-name can-hide">æ¨èç³»ç»Ÿå¼€å‘æ–‡æ¡£</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/nomoe/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¨èç³»ç»Ÿå¼€å‘" class="dropdown-title"><span class="title">æ¨èç³»ç»Ÿå¼€å‘</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ¨èç³»ç»Ÿå¼€å‘" class="mobile-dropdown-title"><span class="title">æ¨èç³»ç»Ÿå¼€å‘</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nomoe/develop/01/" class="nav-link">
  ç¬¬ä¸€è®²
</a></li><li class="dropdown-item"><!----> <a href="/nomoe/develop/02/" class="nav-link">
  ç¬¬äºŒè®²
</a></li><li class="dropdown-item"><!----> <a href="/nomoe/develop/03/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ç¬¬ä¸‰è®²
</a></li><li class="dropdown-item"><!----> <a href="/nomoe/develop/04/" class="nav-link">
  ç¬¬å››è®²
</a></li><li class="dropdown-item"><!----> <a href="/nomoe/develop/05/" class="nav-link">
  ç¬¬äº”è®²
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/nomoe/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¨èç³»ç»Ÿå¼€å‘" class="dropdown-title"><span class="title">æ¨èç³»ç»Ÿå¼€å‘</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ¨èç³»ç»Ÿå¼€å‘" class="mobile-dropdown-title"><span class="title">æ¨èç³»ç»Ÿå¼€å‘</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/nomoe/develop/01/" class="nav-link">
  ç¬¬ä¸€è®²
</a></li><li class="dropdown-item"><!----> <a href="/nomoe/develop/02/" class="nav-link">
  ç¬¬äºŒè®²
</a></li><li class="dropdown-item"><!----> <a href="/nomoe/develop/03/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ç¬¬ä¸‰è®²
</a></li><li class="dropdown-item"><!----> <a href="/nomoe/develop/04/" class="nav-link">
  ç¬¬å››è®²
</a></li><li class="dropdown-item"><!----> <a href="/nomoe/develop/05/" class="nav-link">
  ç¬¬äº”è®²
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/nomoe/develop/03/" aria-current="page" class="active sidebar-link">ç¬¬ä¸‰è®² åˆ†è¯å’Œç´¢å¼•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_1ã€ç´¢å¼•" class="sidebar-link">1ã€ç´¢å¼•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_1ã€å‰è¨€" class="sidebar-link">1ã€å‰è¨€</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_2ã€å»ºç«‹å…¨æ–‡ç´¢å¼•" class="sidebar-link">2ã€å»ºç«‹å…¨æ–‡ç´¢å¼•</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_3ã€æµ‹è¯•" class="sidebar-link">3ã€æµ‹è¯•</a></li></ul></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_2ã€åˆ†è¯" class="sidebar-link">2ã€åˆ†è¯</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_1ã€ç¯å¢ƒæ­å»º" class="sidebar-link">1ã€ç¯å¢ƒæ­å»º</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_2ã€ç¼–å†™æ–°é—»é¢„å¤„ç†é€»è¾‘" class="sidebar-link">2ã€ç¼–å†™æ–°é—»é¢„å¤„ç†é€»è¾‘</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_3ã€æµ‹è¯•æ–°é—»é¢„å¤„ç†" class="sidebar-link">3ã€æµ‹è¯•æ–°é—»é¢„å¤„ç†</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_4ã€å¼•å…¥ç»“å·´åˆ†è¯å’Œmysql" class="sidebar-link">4ã€å¼•å…¥ç»“å·´åˆ†è¯å’ŒMySQL</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_5ã€æ–°å»ºarticle-wordè¡¨å’Œvocabularyè¡¨" class="sidebar-link">5ã€æ–°å»ºarticle_wordè¡¨å’Œvocabularyè¡¨</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_6ã€ä¿®æ”¹æ•°æ®åº“é…ç½®" class="sidebar-link">6ã€ä¿®æ”¹æ•°æ®åº“é…ç½®</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_7ã€ç¼–å†™åˆ†è¯é€»è¾‘" class="sidebar-link">7ã€ç¼–å†™åˆ†è¯é€»è¾‘</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_8ã€è¿è¡Œæµ‹è¯•" class="sidebar-link">8ã€è¿è¡Œæµ‹è¯•</a></li></ul></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_3ã€newsdemowebå®è·µ" class="sidebar-link">3ã€NewsDemoWebå®è·µ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_1ã€åŸºäºå…¨æ–‡ç´¢å¼•çš„æŸ¥è¯¢" class="sidebar-link">1ã€åŸºäºå…¨æ–‡ç´¢å¼•çš„æŸ¥è¯¢</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_2ã€è‡ªå®šä¹‰åˆ†è¯æŸ¥è¯¢" class="sidebar-link">2ã€è‡ªå®šä¹‰åˆ†è¯æŸ¥è¯¢</a></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_3ã€ç¼“å­˜" class="sidebar-link">3ã€ç¼“å­˜</a></li></ul></li><li class="sidebar-sub-header"><a href="/nomoe/develop/03/#_4ã€æ€»ç»“" class="sidebar-link">4ã€æ€»ç»“</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ç¬¬ä¸‰è®²-åˆ†è¯å’Œç´¢å¼•"><a href="#ç¬¬ä¸‰è®²-åˆ†è¯å’Œç´¢å¼•" class="header-anchor">#</a> ç¬¬ä¸‰è®² åˆ†è¯å’Œç´¢å¼•</h1> <hr> <h2 id="_1ã€ç´¢å¼•"><a href="#_1ã€ç´¢å¼•" class="header-anchor">#</a> 1ã€ç´¢å¼•</h2> <h3 id="_1ã€å‰è¨€"><a href="#_1ã€å‰è¨€" class="header-anchor">#</a> 1ã€å‰è¨€</h3> <p><code>MySQL</code> å»ºç«‹ä¸­æ–‡å…¨æ–‡ç´¢å¼•çš„æ–¹å¼ï¼Œèµ„æ–™è§ <code>3_MySQLå…¨æ–‡ç´¢å¼•</code> ç›®å½•ä¸‹çš„æ–‡æ¡£æˆ–è€…å‚è€ƒç½‘ç»œèµ„æ–™</p> <h3 id="_2ã€å»ºç«‹å…¨æ–‡ç´¢å¼•"><a href="#_2ã€å»ºç«‹å…¨æ–‡ç´¢å¼•" class="header-anchor">#</a> 2ã€å»ºç«‹å…¨æ–‡ç´¢å¼•</h3> <p>å¯¹<code>title</code> , <code>content</code> è¿™ä¸¤ä¸ªå­—æ®µå»ºç«‹å…¨æ–‡ç´¢å¼•ï¼Œè¯­å¥å¦‚ä¸‹</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> FULLTEXT <span class="token keyword">index</span> title_content <span class="token keyword">on</span> <span class="token punctuation">`</span>article<span class="token punctuation">`</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> content<span class="token punctuation">)</span> <span class="token keyword">WITH</span> PARSER ngram<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è€å¿ƒç­‰å¾…å³å¯ï¼ŒæœŸé—´ä¸è¦å…³é—­è½¯ä»¶ï¼Œæˆ‘çš„æœºå™¨ç”¨äº† <code>4000</code> å¤šç§’æ‰å»ºå®Œ</p> <h3 id="_3ã€æµ‹è¯•"><a href="#_3ã€æµ‹è¯•" class="header-anchor">#</a> 3ã€æµ‹è¯•</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> article <span class="token keyword">WHERE</span> <span class="token keyword">MATCH</span> <span class="token punctuation">(</span>title<span class="token punctuation">,</span> content<span class="token punctuation">)</span> AGAINST <span class="token punctuation">(</span><span class="token string">'ç¾å¥³'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æŸ¥è¯¢åªèŠ±äº†0.230ç§’ï¼Œè¿˜æ˜¯æŒºå¿«çš„ï¼Œæœ‰çš„åŒå­¦å¯èƒ½åˆšå»ºå®Œç´¢å¼•ï¼Œç„¶åç«‹å³æµ‹è¯•ï¼Œå‘ç°å¾ˆæ…¢ï¼Œè¿™æ—¶é‡å¯ä¸€ä¸‹ <code>MySQL</code> æˆ–ä¸è¦ç”¨Navicatå³å¯ï¼ˆæ¯”å¦‚ç”¨IDEAè‡ªå¸¦çš„æ•°æ®åº“ç®¡ç†å·¥å…·ï¼‰ï¼Œä¸è¿‡ï¼Œæœ‰æ—¶å€™å®ƒçœŸçš„å¾ˆä½›ç³»ğŸ˜’</p> <p><img src="https://img-blog.csdnimg.cn/6155eae41d8b4971be782991ae2e9d9f.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <h2 id="_2ã€åˆ†è¯"><a href="#_2ã€åˆ†è¯" class="header-anchor">#</a> 2ã€åˆ†è¯</h2> <h3 id="_1ã€ç¯å¢ƒæ­å»º"><a href="#_1ã€ç¯å¢ƒæ­å»º" class="header-anchor">#</a> 1ã€ç¯å¢ƒæ­å»º</h3> <p>æ‰“å¼€ <code>IDEA</code> ï¼Œæ–°å»ºä¸€ä¸ª <code>maven</code> é¡¹ç›®ï¼Œè‡³äºä¸ºä»€ä¹ˆç”¨ <code>maven</code>ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ç®¡ç† <code>jar</code> åŒ…ï¼Œé€‰æ‹©<code>quickstart</code>ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥</p> <img src="https://img-blog.csdnimg.cn/8e99f2cbbb6e47c0bd4906d56374a74a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"> <p>è¾“å…¥é¡¹ç›®åï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥</p> <img src="https://img-blog.csdnimg.cn/57210a28358c4f16a0fc0af2e09f7295.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"> <p>ç‚¹å‡»å®Œæˆå³å¯</p> <img src="https://img-blog.csdnimg.cn/829dfe00b23e46dda9b2ac03f1752145.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"> <p>å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æ–°å»ºä¼šä¸‹è½½ä¸€äº›æ’ä»¶ï¼Œè€å¿ƒç­‰å¾…å³å¯ï¼Œç¬¬äºŒæ¬¡æ–°å»ºå°±å¾ˆå¿«äº†</p> <p>æ–°å»ºå®Œé¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚å›¾ï¼š</p> <img src="https://img-blog.csdnimg.cn/5c60f85d88c34319962cb9db10c1ba84.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> <p>ä¿®æ”¹<code>pom.xml</code>ï¼Œå°†ç¼–è¯‘ç‰ˆæœ¬æ¢æˆ1.8</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åˆ é™¤<code>test</code>ï¼Œè®©ç›®å½•æ›´åŠ ç®€æ´ï¼Œç°åœ¨åªå‰©<code>App</code>ï¼Œè¿è¡Œ <code>App</code> ï¼Œæ‰“å°å‡º <code>Hello World!</code></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>Hello World<span class="token operator">!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2ã€ç¼–å†™æ–°é—»é¢„å¤„ç†é€»è¾‘"><a href="#_2ã€ç¼–å†™æ–°é—»é¢„å¤„ç†é€»è¾‘" class="header-anchor">#</a> 2ã€ç¼–å†™æ–°é—»é¢„å¤„ç†é€»è¾‘</h3> <p>åˆ é™¤ <code>App</code>ï¼Œæ–°å»ºåŒ… <code>process</code>ï¼ŒåŒ…ä¸‹æ–°å»ºç±» <code>TransformNewsTest</code>ï¼Œå¯¹æ–°é—»æ–‡ä»¶è¿›è¡Œé¢„å¤„ç†ï¼Œç”±äºä¼šç”¨åˆ°å…¨è§’è½¬åŠè§’çš„å·¥å…·ç±» <code>StringUtil</code>ï¼Œæ‰€ä»¥å†æ–°å»ºåŒ… <code>utils</code> ï¼ŒåŒ…ä¸‹æŠŠä¹‹å‰çš„ <code>StringUtil</code> æ‹·è´è¿‡æ¥</p> <blockquote><p>ç–‘é—®ï¼šä¸ºä»€ä¹ˆè¿›è¡Œæ–°é—»é¢„å¤„ç†ï¼Ÿ</p> <p>å›ç­”ï¼šå› ä¸ºä¸ºäº†è®©æ–°é—»åˆ†è¯å¯¼å…¥æ•°æ®åº“é€»è¾‘æ›´åŠ ç®€æ´äº¿ç‚¹ï¼Œæ–°é—»åˆ†è¯å¯¼å…¥æ•°æ®åº“çš„é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥èƒ½åˆ†å¼€å¤„ç†çš„ä¸œè¥¿å°½é‡åˆ†å¼€å¤„ç†</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>example<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * å…¨åŠè§’è½¬æ¢å·¥å…·ç±»
 *
 * @author Jack
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringUtil</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
    * å…¨è§’è½¬åŠè§’
    *
    * @param input String.
    * @return åŠè§’å­—ç¬¦ä¸²
    */</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">toDbc</span><span class="token punctuation">(</span><span class="token class-name">String</span> input<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> c <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> c<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\u3000'</span> <span class="token operator">||</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\ue40c'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">' '</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token string">'\uFF00'</span> <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token string">'\uFF5F'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">65248</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>åœ¨<code>TransformNewsTest</code>çš„ <code>main</code> æ–¹æ³•ä¸­ï¼Œé¦–å…ˆå†™å¥½ç»“æ„</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼€å§‹è½¬æ¢...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è½¬æ¢æ–°é—»çš„ä¸»è¦é€»è¾‘</span>
    <span class="token function">transformNews</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è½¬æ¢ç»“æŸ...ï¼Œè€—æ—¶&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;æ¯«ç§’&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ç„¶ååˆ›å»º <code>transformNews</code> æ–¹æ³•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">transformNews</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç¼–å†™ä¸šåŠ¡...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å®šä¹‰åŸºæœ¬çš„å˜é‡</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// è¡Œå·è®¡æ•°å™¨</span>
<span class="token keyword">int</span> lineNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸´æ—¶å­˜æ”¾æ ‡é¢˜å’Œå†…å®¹</span>
<span class="token class-name">String</span> title <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> content <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// è¾“å…¥æ–‡ä»¶ä½ç½®</span>
<span class="token class-name">String</span> originFilePath <span class="token operator">=</span> <span class="token string">&quot;F:\\news_data\\news_origin_data.dat&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// è¾“å‡ºæ–‡ä»¶ä½ç½®</span>
<span class="token class-name">String</span> outputFilePath <span class="token operator">=</span> <span class="token string">&quot;F:\\news_data\\news_transform_data.dat&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// è¾“å…¥æµ</span>
<span class="token class-name">BufferedReader</span> bufferedReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>originFilePath<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;GBK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è¾“å‡ºæµ</span>
<span class="token class-name">BufferedWriter</span> bufferedWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>outputFilePath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å­˜æ”¾æ¯è¡Œå†…å®¹</span>
<span class="token class-name">String</span> line <span class="token operator">=</span> bufferedWriter<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>ç„¶åå¾ªç¯éå†ï¼Œå¤„ç†æ¯ç¯‡æ–°é—»</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// éå†æ¯ä¸€è¡Œ</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>line <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¡Œå·è‡ªå¢</span>
  lineNumber<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token comment">// è¡Œå·æ¨¡6ç­‰äº4ä¸ºæ–°é—»æ ‡é¢˜</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lineNumber <span class="token operator">%</span> <span class="token number">6</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    title <span class="token operator">=</span> line<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è¡Œå·æ¨¡6ç­‰äº5ä¸ºæ–°é—»å†…å®¹</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lineNumber <span class="token operator">%</span> <span class="token number">6</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    content <span class="token operator">=</span> line<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// æ¯6è¡Œä¸ºä¸€ç‰‡æ–°é—»ï¼Œè¿›è¡Œå¤„ç†</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>lineNumber <span class="token operator">%</span> <span class="token number">6</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœæ–°é—»æ ‡é¢˜å’Œå†…å®¹éƒ½ä¸ä¸ºç©º</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&quot;&lt;contenttitle&gt;&lt;/contenttitle&gt;&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token string">&quot;&lt;content&gt;&lt;/content&gt;&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å†™å…¥æ–°é—»æ ‡é¢˜</span>
      bufferedWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">transformContent</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">&quot;contenttitle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// æ¢è¡Œ</span>
      bufferedWriter<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å†™å…¥æ–°é—»å†…å®¹</span>
      bufferedWriter<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">transformContent</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      bufferedWriter<span class="token punctuation">.</span><span class="token function">newLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// è¯»å–ä¸‹ä¸€è¡Œ</span>
  line <span class="token operator">=</span> bufferedReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><code>transformContent</code> æ–¹æ³•ï¼Œå°†å†…å®¹è½¬æ¢æˆæˆ‘ä»¬è¦çš„äºšå­</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">transformContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">,</span> <span class="token class-name">String</span> tag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token class-name">StringUtil</span><span class="token punctuation">.</span><span class="token function">toDbc</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> tag<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// åŠè§’ç©ºæ ¼è½¬å…¨è§’ç©ºæ ¼</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'\uE40c'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span>
    <span class="token comment">// å»æ‰æ•°å­—</span>
    <span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;\\d+&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// å»æ‰ç¬¦å·</span>
    <span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">&quot;[\\pP\\p{Punct}]&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>getContent</code> æ–¹æ³•ï¼Œæå–æ ‡ç­¾é‡Œçš„å†…å®¹</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> text<span class="token punctuation">,</span> <span class="token class-name">String</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> payloadLength <span class="token operator">=</span> payload<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> text<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>payloadLength <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> text<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> payloadLength <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æœ€ååˆ«å¿˜è®°å…³é—­æµ</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// å…³é—­æµ</span>
bufferedReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
bufferedWriter<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å½“ç„¶ï¼Œè¿™ç§å…³é—­æµçš„æ–¹å¼ä¸æ˜¯æœ€ä½³çš„ï¼Œä½†æ˜¯ä¸ºäº†è®©ä»£ç æ›´ç®€æ´ï¼Œæš‚æ—¶ä¸è€ƒè™‘è¿™äº›é—®é¢˜ï¼Œå¤§å®¶æ„Ÿå…´è¶£å¯ä»¥è‡ªè¡Œç ”ç©¶</p> <blockquote><p>æ³¨æ„ï¼š</p> <ol><li>æ–°é—»è¿™å—æˆ‘æŠŠæ•°å­—å»æ‰äº†ï¼Œå› ä¸ºæœç´¢æ–°é—»çš„æ—¶å€™æŒ‰ç…§å¸¸ç†ä¸ä¼šæœç´¢æ•°å­—ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æœç´¢æ•°å­—æ²¡æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠå®ƒå»æ‰äº†ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„ç†è§£æ¥</li> <li>æˆ‘è¿™é‡Œåªæå–æ–°é—»çš„æ ‡é¢˜å’Œå†…å®¹ï¼Œå› ä¸ºæˆ‘ä»¬è¦åˆ†è¯çš„å°±æ˜¯è¿™ä¸¤ä¸ªéƒ¨åˆ†</li></ol></blockquote> <h3 id="_3ã€æµ‹è¯•æ–°é—»é¢„å¤„ç†"><a href="#_3ã€æµ‹è¯•æ–°é—»é¢„å¤„ç†" class="header-anchor">#</a> 3ã€æµ‹è¯•æ–°é—»é¢„å¤„ç†</h3> <p>è¿è¡Œ <code>main</code> æ–¹æ³•ï¼Œç­‰å¾…è¿›ç¨‹è¿è¡Œç»“æŸå³å¯</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>å¼€å§‹è½¬æ¢<span class="token punctuation">..</span>.
è½¬æ¢ç»“æŸ<span class="token punctuation">..</span>.ï¼Œè€—æ—¶33353æ¯«ç§’
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æ‰“å¼€å¤„ç†åçš„æ–‡ä»¶ï¼Œå¤§æ¦‚é•¿è¿™æ ·ï¼Œè¿™é‡Œæˆªå–ç¬¬ä¸€ç¯‡æ–‡ç« </p> <div class="language- line-numbers-mode"><pre class="language-text"><code>æ·±åœ³åœ°é“å°†è®¾ç«‹VIPå¤´ç­‰è½¦å¢ ä¹°åŒå€ç¥¨å¯äº«åç¥¨
å—éƒ½è®¯ è®°è€…åˆ˜å‡¡ å‘¨æ˜Œå’Œ ä»»ç¬‘ä¸€ ç»§æ¨å‡ºæ—¥ç¥¨åæ·±åœ³ä»Šåå°†è®¾åœ°é“VIPå¤´ç­‰è½¦å¢è®¾åç¥¨åˆ¶æ˜¨æ—¥å—éƒ½METROåˆ›åˆŠä»ªå¼æš¨å¹´æ·±æ¸¯åœ°é“åœˆé«˜å³°è®ºå›ä¸Šé€éœ²åœ¨æœªæ¥çš„å·çº¿ä¸Šå°†å¢åŠ ç‰¹è‰²æœåŠ¡æ»¡è¶³ä¸åŒæ¶ˆè´¹å±‚æ¬¡çš„ä¹˜å®¢çš„ä¸åŒéœ€æ±‚å¦‚ç‰¹è®¾è¡Œææ¶çš„è½¦å¢å’Œä¹°åŒå€ç¥¨å¯æœ‰åº§ä½åçš„VIPè½¦å¢ç­‰ è®ºå›ä¸Šæ·±åœ³å¸‚æ”¿åºœå‰¯ç§˜ä¹¦é•¿è½¨é“äº¤é€šå»ºè®¾åŠå…¬å®¤ä¸»ä»»èµµé¹æ—é€éœ²åœ°é“æœªæ¥çš„æ–¹å‘å°†åˆ†ç­‰çº§æ»¡è¶³ä¸åŒå±‚æ¬¡çš„äººçš„éœ€æ±‚æä¾›ä¸åŒå±‚æ¬¡çš„æœ‰é’ˆå¯¹çš„æœåŠ¡å…¶ä¸­åŒ…æ‹¬ä¸€äº›æ¡£æ¬¡ç¨å¾®é«˜ä¸€äº›çš„æœåŠ¡æˆ‘ä»¬è¦è®©å…¬å…±äº¤é€šä¹Ÿèƒ½æ»¡è¶³æ¡£æ¬¡ç¨é«˜ä¸€äº›çš„æœåŠ¡æ¯”å¦‚å°è¯•æœ‰åº§ä½çš„åœ°é“ç¥¨æœåŠ¡å°¤å…¶æ˜¯ä¸€äº›è¿œé“è€Œæ¥çš„ä¹˜å®¢é€šè¿‡æä¾›åç¥¨æœåŠ¡è®©ä¹˜ååœ°é“ä¹Ÿèƒ½äº«å—åˆ°éå¸¸èˆ’é€‚çš„ä½“éªŒä»–è¯´è¿™ç§åç¥¨çš„æœåŠ¡æœ‰æœ›åœ¨åœ°é“æœŸä¸Šå®è¡Œå°†åŠ æŒ‚èŠ‚è½¦å¢ä»¥å®æ–½èŠ±é’±å¯ä¹°åº§ä½çš„æœåŠ¡ æˆ‘ä»¬å¸Œæœ›è½¨é“äº¤é€šå’Œå®¶é‡Œå¼€çš„è½¦ä¸€æ ·åˆ†å¾ˆå¤šç§èµµé¹æ—è¯´æ¯”å¦‚æœ‰äº›åœ°é“æ˜¯è§‚å…‰çº¿ä¸ä»…æ²¿é€”çš„é£å…‰éå¸¸å¥½è¿˜èƒ½å‡­ä¸€å¼ ç¥¨æ— æ•°æ¬¡ä¸Šä¸‹å¦‚åŒæ—…æ¸¸æ—¶æä¾›çš„é€šç¥¨æœåŠ¡å†æ¯”å¦‚è®¾ç«‹å¯ä»¥æ”¾å¤§ä»¶è¡Œæçš„è½¦å¢ä»Šåé€šè¿‡è®¾ä¸“é—¨å¯æ”¾å¤§ä»¶è¡Œæçš„åº§ä½é¿å…åƒç°åœ¨æ”¾è¡Œæä¸å¤ªæ–¹ä¾¿çš„ç°è±¡æœªæ¥åœ°é“åˆæ­¥ä¸ä»…åœ¨å¹²çº¿ä¸Šé“ºè®¾è¿˜ä¼šåœ¨æ”¯çº¿åŸé™…çº¿ä¸Šå»å»ºè®¾ è§‰å¾—å¦‚æœè½¦è´¹ä¸å¤ªè´µçš„è¯è¿˜æ˜¯æ„¿æ„è€ƒè™‘çš„æ˜¨æ—¥å¸‚æ°‘é»„å°å§è¡¨ç¤ºå°¤å…¶æ˜¯ä»è€è¡—åˆ°æœºåœºè¿™ä¸€æ®µè€è¡—ç«™æ¯æ¬¡ä¸Šä¸‹å®¢éƒ½å¾ˆå¤šäººè€Œå¦‚æœèµ¶ä¸Šä¸Šä¸‹ç­é«˜å³°æœŸç‰¹åˆ«æ‹¥æŒ¤è¦ä¸€è·¯ä»è€è¡—ç«™ç«™åˆ°æœºåœºåˆ†é’Ÿè¿˜æ˜¯æŒºåƒåŠ›çš„å®æ„¿å¤šèŠ±ç‚¹é’±ä¹Ÿèƒ½ç¨å¾®èˆ’é€‚ä¸€ç‚¹ä½†æ˜¯ç™½é¢†æ—å…ˆç”Ÿåˆ™è¡¨ç¤ºè‡ªå·±æ¯å¤©ä¸Šä¸‹ç­éƒ½è¦ååœ°é“å‡ºåŒå€è½¦èµ„ä¹°åç¥¨è´¹ç”¨æœ‰ç‚¹é«˜
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_4ã€å¼•å…¥ç»“å·´åˆ†è¯å’Œmysql"><a href="#_4ã€å¼•å…¥ç»“å·´åˆ†è¯å’Œmysql" class="header-anchor">#</a> 4ã€å¼•å…¥ç»“å·´åˆ†è¯å’Œ<code>MySQL</code></h3> <p><code>pom.xml</code> ä¾èµ–é‡Œé¢åŠ å…¥ç»“å·´åˆ†è¯ä¾èµ–ï¼Œç„¶åæ›´æ–° <code>maven</code> å³å¯</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.huaban<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jieba-analysis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.1.47<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>é¡¹ç›®åŒ…ä¸‹æ–°å»º <code>test</code> åŒ…ï¼ŒåŒ…ä¸‹æ–°å»º <code>JieBaTest</code> ç±»ï¼Œæµ‹è¯•ç»“å·´åˆ†è¯</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>example<span class="token punctuation">.</span>process</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>huaban<span class="token punctuation">.</span>analysis<span class="token punctuation">.</span>jieba<span class="token punctuation">.</span></span><span class="token class-name">JiebaSegmenter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>huaban<span class="token punctuation">.</span>analysis<span class="token punctuation">.</span>jieba<span class="token punctuation">.</span></span><span class="token class-name">SegToken</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JieBaTest</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token string">&quot;æˆ‘æ¥åˆ°åŒ—äº¬æ¸…åå¤§å­¦&quot;</span><span class="token punctuation">;</span>
    <span class="token class-name">JiebaSegmenter</span> jiebaSegmenter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JiebaSegmenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> tokenList <span class="token operator">=</span> jiebaSegmenter<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token class-name">JiebaSegmenter<span class="token punctuation">.</span>SegMode</span><span class="token punctuation">.</span>SEARCH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SegToken</span> token <span class="token operator">:</span> tokenList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>token<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>è¿è¡Œç»“æœï¼š</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>æˆ‘
æ¥åˆ°
åŒ—äº¬
æ¸…åå¤§å­¦
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_5ã€æ–°å»ºarticle-wordè¡¨å’Œvocabularyè¡¨"><a href="#_5ã€æ–°å»ºarticle-wordè¡¨å’Œvocabularyè¡¨" class="header-anchor">#</a> 5ã€æ–°å»º<code>article_word</code>è¡¨å’Œ<code>vocabulary</code>è¡¨</h3> <p>å½“ç„¶å•¦ï¼Œè¿™é‡Œè¿˜éœ€è¦å†æ–°å»ºå¤šä¸¤ä¸ªè¡¨ <code>vocabulary2</code> å’Œ <code>temp</code>ï¼Œ<code>vocabulary2</code> å’Œ <code>vocabulary</code>è¡¨ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œè‡³äºæœ‰ä»€ä¹ˆç”¨ï¼Œåç»­ä¼šè®²åˆ°</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- æ–°å»º`article_word`è¡¨</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>article_word<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>article_word<span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">BIGINT</span> <span class="token punctuation">(</span> <span class="token number">20</span> <span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>article_id<span class="token punctuation">`</span> <span class="token keyword">BIGINT</span> <span class="token punctuation">(</span> <span class="token number">20</span> <span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>word<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span> <span class="token number">240</span> <span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>freqs<span class="token punctuation">`</span> <span class="token keyword">INT</span> <span class="token punctuation">(</span> <span class="token number">11</span> <span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>freqs_title<span class="token punctuation">`</span> <span class="token keyword">INT</span> <span class="token punctuation">(</span> <span class="token number">11</span> <span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>freqs_content<span class="token punctuation">`</span> <span class="token keyword">INT</span> <span class="token punctuation">(</span> <span class="token number">11</span> <span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span> <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> MyISAM <span class="token keyword">AUTO_INCREMENT</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>

<span class="token comment">-- æ–°å»º`vocabulary`è¡¨</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>vocabulary<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>vocabulary<span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>word<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span> <span class="token number">250</span> <span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> 
	<span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>freqs<span class="token punctuation">`</span> <span class="token keyword">INT</span> <span class="token punctuation">(</span> <span class="token number">11</span> <span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span> <span class="token punctuation">`</span>word<span class="token punctuation">`</span> <span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span> 
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> MyISAM <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>

<span class="token comment">-- æ–°å»º`vocabulary2`è¡¨</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>vocabulary2<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>vocabulary<span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>word<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span> <span class="token number">250</span> <span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> 
	<span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>freqs<span class="token punctuation">`</span> <span class="token keyword">INT</span> <span class="token punctuation">(</span> <span class="token number">11</span> <span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span> <span class="token punctuation">`</span>word<span class="token punctuation">`</span> <span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span> 
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> MyISAM <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>

<span class="token comment">-- æ–°å»º`temp`è¡¨</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span><span class="token keyword">temp</span><span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">INT</span> <span class="token punctuation">(</span> <span class="token number">11</span> <span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>word<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span> <span class="token number">255</span> <span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> 
	<span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>freqs<span class="token punctuation">`</span> <span class="token keyword">INT</span> <span class="token punctuation">(</span> <span class="token number">11</span> <span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span> <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span> 
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> MyISAM <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="_6ã€ä¿®æ”¹æ•°æ®åº“é…ç½®"><a href="#_6ã€ä¿®æ”¹æ•°æ®åº“é…ç½®" class="header-anchor">#</a> 6ã€ä¿®æ”¹æ•°æ®åº“é…ç½®</h3> <p><code>my.ini</code> æ–‡ä»¶çš„ <code>[mysqld]</code> ä¸­æœ€ååŠ å…¥ï¼š</p> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token key attr-name">bulk_insert_buffer_size</span><span class="token punctuation">=</span><span class="token value attr-value">100Mï¼Œ</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¿®æ”¹ <code>max_allowed_packet=100M</code> ï¼Œå¦‚æœæ²¡æœ‰åˆ™åœ¨ <code>[mysqld]</code> æœ€åæ·»åŠ ï¼Œç„¶åé‡å¯æœåŠ¡</p> <p>ä¸ºä»€ä¹ˆè¦ä¿®æ”¹é…ç½®ï¼Ÿ</p> <p>å› ä¸ºå¸®åŠ©æˆ‘ä»¬æé«˜æ’å…¥æ€§èƒ½ï¼Œæˆ‘ä»¬æ¯æ¬¡æ‰§è¡Œæ’å…¥çš„æ•°æ®é‡å¾ˆå¤§ï¼Œæ‰€ä»¥è¦æŠŠè¿™ä¸¤ä¸ªå‚æ•°è°ƒå¾—å¤§ä¸€ç‚¹</p> <h3 id="_7ã€ç¼–å†™åˆ†è¯é€»è¾‘"><a href="#_7ã€ç¼–å†™åˆ†è¯é€»è¾‘" class="header-anchor">#</a> 7ã€ç¼–å†™åˆ†è¯é€»è¾‘</h3> <p>é¦–å…ˆï¼Œç”±äºéƒ¨åˆ†é€»è¾‘ä¸èƒ½å¸è½½é™æ€æ–¹æ³•é‡Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨å•å…ƒæµ‹è¯•è¿è¡Œä¸šåŠ¡é€»è¾‘</p> <p><code>pom.xml</code> ä¿®æ”¹å…³äº <code>junit</code> çš„é…ç½®ï¼ŒæŠŠ <code>&lt;scope&gt;test&lt;/scope&gt;</code> å»æ‰</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å…ˆçœ‹ä¸»é€»è¾‘ï¼Œåˆå§‹åŒ–ä¸€äº›å…¨å±€å˜é‡-&gt;å¯¼å…¥<code>ArticleWord</code>-&gt;å…³é—­æ•°æ®åº“çš„è¿æ¥</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼€å§‹è®¡æ—¶...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// åˆå§‹åŒ–ä¸€äº›å…¨å±€å˜é‡</span>
  <span class="token function">initGlobalVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å¯¼å…¥ArticleWord</span>
  <span class="token function">importArticleWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å…³é—­æ•°æ®åº“çš„è¿æ¥</span>
  <span class="token class-name">DatabaseUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> preparedStatement<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡æ—¶ç»“æŸ...æ€»å…±è€—æ—¶&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;æ¯«ç§’&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>å…¨å±€å˜é‡ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * PreparedStatement
 */</span>
<span class="token keyword">private</span> <span class="token class-name">PreparedStatement</span> preparedStatement<span class="token punctuation">;</span>

<span class="token comment">/**
 * æ•°æ®åº“è¿æ¥
 */</span>
<span class="token keyword">private</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">;</span>

<span class="token comment">/**
 * æ–°é—»çš„åˆ†è¯é¢‘ç‡è¡¨
 */</span>
<span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> titleFrequencyMap<span class="token punctuation">,</span> contentFrequencyMap<span class="token punctuation">;</span>

<span class="token comment">/**
 * è·å–æ–°é—»xmlçš„æ–‡ä»¶è¯»å–æµ
 */</span>
<span class="token keyword">private</span> <span class="token class-name">BufferedReader</span> bufferReader<span class="token punctuation">;</span>

<span class="token comment">/**
 * åœç”¨è¯é›†åˆ
 */</span>
<span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stopWordsSet<span class="token punctuation">;</span>

<span class="token comment">/**
 * ç»“å·´åˆ†è¯å™¨
 */</span>
<span class="token keyword">private</span> <span class="token class-name">JiebaSegmenter</span> jiebaSegmenter<span class="token punctuation">;</span>

<span class="token comment">/**
 * æ’å…¥è¯­å¥åç¼€
 */</span>
<span class="token keyword">private</span> <span class="token class-name">StringBuilder</span> suffix<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>å…¶ä¸­ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼š<strong>æ–°é—»çš„åˆ†è¯é¢‘ç‡è¡¨</strong>æŒ‡çš„æ˜¯æ¯ç¯‡æ–°é—»çš„è¯æ±‡-è¯æ±‡åœ¨æ–°é—»æ ‡é¢˜æˆ–æ­£æ–‡ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œ<strong>æ’å…¥è¯­å¥åç¼€</strong>ä¸€è¯åœ¨ç¬¬ä¸€ç« å‡ºç°è¿‡ï¼Œå’Œç¬¬ä¸€ç« æ–°é—»å¯¼å…¥æ•°æ®åº“çš„æ€æƒ³ä¸€è‡´ï¼Œéƒ½æ˜¯ä¸ºäº†æé«˜æ’å…¥é€Ÿåº¦ï¼Œé‡‡å–æ‰‹åŠ¨æ‹¼æ¥çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ <code>prepareStatement</code> çš„å ä½ç¬¦å½¢å¼ï¼Œå› ä¸ºå®ƒçš„é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œä½†æ˜¯æˆ‘ä»¬è¿½æ±‚é€Ÿåº¦ï¼Œæ‰€ä»¥å¿…é¡»é‡‡ç”¨æ›´é«˜æ•ˆçš„ç®—æ³•~</p> <ol><li><code>initGlobalVariables</code>ï¼š</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 1 åˆå§‹åŒ–å˜é‡
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initGlobalVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–æ•°æ®åº“è¿æ¥å’ŒpreparedStatement</span>
  connection <span class="token operator">=</span> <span class="token class-name">DatabaseUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  preparedStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// åŠ è½½åœç”¨è¯</span>
  stopWordsSet <span class="token operator">=</span> <span class="token function">loadStopWords</span><span class="token punctuation">(</span><span class="token class-name">ImportArticleWordTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;stop_words.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// åˆå§‹åŒ–ç»“å·´åˆ†è¯å™¨å’Œæ’å…¥è¯­å¥åç¼€</span>
  jiebaSegmenter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JiebaSegmenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  suffix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// è·å–æ–°é—»æ–‡ä»¶è¾“å…¥æµ</span>
  <span class="token class-name">String</span> filePath <span class="token operator">=</span> <span class="token string">&quot;F:\\news_data\\news_transform_data.dat&quot;</span><span class="token punctuation">;</span>
  bufferReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>
      <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
  * 1.1 åŠ è½½åœç”¨è¯ï¼Œæ–¹æ³•æ¥è‡ªç»“å·´åˆ†è¯æºç 
  */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadStopWords</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> in<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">BufferedReader</span> buff<span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> line<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>line <span class="token operator">=</span> buff<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      buff<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> set<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><ol start="2"><li><code>importArticleWord()</code>ï¼šè¿™é‡Œé¢æ˜¯ä¸»è¦çš„æ’å…¥é€»è¾‘ï¼Œæˆ‘ä»¬é‡‡å–çš„æ˜¯è¯»æ–‡ä»¶æ’å…¥ï¼Œå…¶å®ä¹Ÿå¯ä»¥åˆ©ç”¨ <code>article</code> æ•°æ®åº“ï¼Œä½†æ˜¯é‚£æ ·ä¹Ÿå¾ˆæ…¢ï¼Œè¿œæ²¡æœ‰è¯»æ–‡ä»¶å¿«</li></ol> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 2 å¯¼å…¥ArticleWord
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">importArticleWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token comment">// rowä»£è¡¨ç¬¬å‡ è¡Œï¼ŒnewsAmountä»£è¡¨ç°åœ¨æ˜¯ç¬¬å‡ ç¯‡æ–°é—»</span>
  <span class="token keyword">int</span> lineNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> newsID <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// å­˜æ”¾æ ‡é¢˜å’Œå†…å®¹</span>
  <span class="token class-name">String</span> title <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> content<span class="token punctuation">;</span>
  <span class="token comment">// å­˜å‚¨æ¯è¡Œçš„å†…å®¹</span>
  <span class="token class-name">String</span> line <span class="token operator">=</span> bufferReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å¼€å§‹è¯»å–æ–°é—»</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>line <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lineNumber<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// è¡Œæ•°è‡ªå¢</span>
    <span class="token comment">// å•æ•°è¡Œtitleï¼Œæ”¾åˆ°titleå˜é‡</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>lineNumber <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      title <span class="token operator">=</span> line<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// åŒæ•°è¡Œcontentï¼Œå’Œtitleç»„æˆä¸€ç¯‡æ–°é—»ï¼Œå¼€å§‹å¤„ç†</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>lineNumber <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      content <span class="token operator">=</span> line<span class="token punctuation">;</span>
      <span class="token comment">// æ–°é—»ç¯‡æ•°è‡ªå¢</span>
      newsID<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token comment">// ç”Ÿæˆå’Œæ‹¼æ¥åç¼€</span>
      suffix <span class="token operator">=</span> <span class="token function">generateSuffix</span><span class="token punctuation">(</span>newsID<span class="token punctuation">,</span> title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// éå†å®Œæ¯1000ç¯‡æ–°é—»ï¼ˆ2000è¡Œï¼‰æ‰§è¡Œä¸€æ¬¡æ’å…¥</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newsID <span class="token operator">%</span> <span class="token number">1000</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> suffix<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">insertArticleWord</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ’å…¥å®Œ&quot;</span> <span class="token operator">+</span> newsID <span class="token operator">+</span> <span class="token string">&quot;ç¯‡æ–‡ç« ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é‡æ–°åˆå§‹åŒ–æ’å…¥è¯­å¥åç¼€</span>
        suffix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// è¯»å–ä¸‹ä¸€è¡Œ</span>
    line <span class="token operator">=</span> bufferReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// æœ€åçš„è¿˜å‰©ä¸è¶³1000æ¡ä¹Ÿè¦æ’å…¥</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>suffix<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">insertArticleWord</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>2.1 <code>generateSuffix</code>ï¼šç”Ÿæˆå’Œæ‹¼æ¥<code>sql</code>è¯­å¥åç¼€</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
  * 2.1 ç”Ÿæˆæ’å…¥è¯­å¥åç¼€
  */</span>
<span class="token keyword">public</span> <span class="token class-name">StringBuilder</span> <span class="token function">generateSuffix</span><span class="token punctuation">(</span><span class="token keyword">int</span> newsID<span class="token punctuation">,</span> <span class="token class-name">String</span> newsTitle<span class="token punctuation">,</span> <span class="token class-name">String</span> newContent<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// æ–°é—»æ ‡é¢˜å’Œå†…å®¹åˆ†åˆ«åˆ†è¯</span>
  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> titleTokenList <span class="token operator">=</span> <span class="token function">separateWords</span><span class="token punctuation">(</span>newsTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> contentTokenList <span class="token operator">=</span> <span class="token function">separateWords</span><span class="token punctuation">(</span>newContent<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// è®¡ç®—æ ‡é¢˜å’Œå†…å®¹è¯æ±‡çš„é¢‘ç‡</span>
  titleFrequencyMap <span class="token operator">=</span> <span class="token function">calculateWordFrequency</span><span class="token punctuation">(</span>stopWordsSet<span class="token punctuation">,</span> titleTokenList<span class="token punctuation">)</span><span class="token punctuation">;</span>
  contentFrequencyMap <span class="token operator">=</span> <span class="token function">calculateWordFrequency</span><span class="token punctuation">(</span>stopWordsSet<span class="token punctuation">,</span> contentTokenList<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// éå†å†…å®¹çš„è¯æ±‡-é¢‘ç‡è¡¨</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> contentFrequencyMap<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    suffix<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">buildSqlSuffix</span><span class="token punctuation">(</span>newsID<span class="token punctuation">,</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    titleFrequencyMap<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// éå†æ ‡é¢˜çš„è¯æ±‡-é¢‘ç‡è¡¨</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> titleFrequencyMap<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    suffix<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">buildSqlSuffix</span><span class="token punctuation">(</span>newsID<span class="token punctuation">,</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> suffix<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
  * 2.1.1 åˆ†è¯
  */</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> <span class="token function">separateWords</span><span class="token punctuation">(</span><span class="token class-name">String</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> jiebaSegmenter<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token class-name">JiebaSegmenter<span class="token punctuation">.</span>SegMode</span><span class="token punctuation">.</span>SEARCH<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
  * 2.1.2 è®¡ç®—è¯æ±‡åˆ—è¡¨é‡Œæ¯ä¸ªè¯æ±‡å‡ºç°çš„é¢‘ç‡
  */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">calculateWordFrequency</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stopWordsSet<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> segTokenList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> frequency <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SegToken</span> segToken <span class="token operator">:</span> segTokenList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopWordsSet<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> segToken<span class="token punctuation">.</span>word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>frequency<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        frequency<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">,</span> frequency<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        frequency<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> frequency<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
  * 2.1.3 æ„å»ºsqlåç¼€
  */</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">buildSqlSuffix</span><span class="token punctuation">(</span><span class="token keyword">int</span> newsID<span class="token punctuation">,</span> <span class="token class-name">String</span> keyword<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> titleWordFrequency <span class="token operator">=</span> titleFrequencyMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> titleFrequencyMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> contentWordFrequency <span class="token operator">=</span> contentFrequencyMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> contentFrequencyMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> totalWordFrequency <span class="token operator">=</span> titleWordFrequency <span class="token operator">+</span> contentWordFrequency<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> newsID <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> keyword <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> totalWordFrequency <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> titleWordFrequency <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> contentWordFrequency <span class="token operator">+</span> <span class="token string">&quot;),&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p>2.2 <code>insertArticleWord</code>ï¼šæ’å…¥<code>ArticleWord</code>åˆ°æ•°æ®åº“</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 2.2 æ’å…¥ArticleWordåˆ°æ•°æ®åº“
 */</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insertArticleWord</span><span class="token punctuation">(</span><span class="token class-name">StringBuilder</span> sqlSuffix<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> sqlPrefix <span class="token operator">=</span> <span class="token string">&quot;INSERT delayed INTO article_word(article_id, word, freqs, freqs_title, freqs_content) VALUES &quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// substringæ˜¯å› ä¸ºæœ€åä¸€ä¸ª','è¦å»æ‰ values(),(),(), -&gt; values(),(),()</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> sqlPrefix <span class="token operator">+</span> sqlSuffix<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> sqlSuffix<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    preparedStatement<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    preparedStatement<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å®Œæ•´ä»£ç ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>example<span class="token punctuation">.</span>process</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>huaban<span class="token punctuation">.</span>analysis<span class="token punctuation">.</span>jieba<span class="token punctuation">.</span></span><span class="token class-name">JiebaSegmenter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>huaban<span class="token punctuation">.</span>analysis<span class="token punctuation">.</span>jieba<span class="token punctuation">.</span></span><span class="token class-name">SegToken</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>example<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">DatabaseUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Connection</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">PreparedStatement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">SQLException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 2ã€åˆ†è¯ç”Ÿæˆarticle_wordï¼ˆä¸å¸¦tfidfå’Œbayesï¼‰
 * æ³¨æ„ï¼šmy.iniæ–‡ä»¶çš„[mysqld]ä¸­æœ€ååŠ å…¥ï¼šbulk_insert_buffer_size=100Mï¼Œ
 * ä¿®æ”¹max_allowed_packet=100Mï¼Œç„¶åé‡å¯æœåŠ¡
 *
 * @author Jack
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImportArticleWordTest</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * PreparedStatement
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">PreparedStatement</span> preparedStatement<span class="token punctuation">;</span>

    <span class="token comment">/**
     * æ•°æ®åº“è¿æ¥
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">;</span>

    <span class="token comment">/**
     * æ–°é—»çš„åˆ†è¯é¢‘ç‡è¡¨
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> titleFrequencyMap<span class="token punctuation">,</span> contentFrequencyMap<span class="token punctuation">;</span>

    <span class="token comment">/**
     * è·å–æ–°é—»xmlçš„æ–‡ä»¶è¯»å–æµ
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">BufferedReader</span> bufferReader<span class="token punctuation">;</span>

    <span class="token comment">/**
     * åœç”¨è¯é›†åˆ
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stopWordsSet<span class="token punctuation">;</span>

    <span class="token comment">/**
     * ç»“å·´åˆ†è¯å™¨
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">JiebaSegmenter</span> jiebaSegmenter<span class="token punctuation">;</span>

    <span class="token comment">/**
     * æ’å…¥è¯­å¥åç¼€
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">StringBuilder</span> suffix<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 1.åˆå§‹åŒ–å˜é‡
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initGlobalVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–æ•°æ®åº“è¿æ¥å’ŒpreparedStatement</span>
        connection <span class="token operator">=</span> <span class="token class-name">DatabaseUtil</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        preparedStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åŠ è½½åœç”¨è¯</span>
        stopWordsSet <span class="token operator">=</span> <span class="token function">loadStopWords</span><span class="token punctuation">(</span><span class="token class-name">ImportArticleWordTest</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;stop_words.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆå§‹åŒ–ç»“å·´åˆ†è¯å™¨å’Œæ’å…¥è¯­å¥åç¼€</span>
        jiebaSegmenter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JiebaSegmenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        suffix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è·å–æ–°é—»æ–‡ä»¶è¾“å…¥æµ</span>
        <span class="token class-name">String</span> filePath <span class="token operator">=</span> <span class="token string">&quot;F:\\news_data\\news_transform_data.dat&quot;</span><span class="token punctuation">;</span>
        bufferReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span>
                <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>
                        <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8
                <span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 1.1 åŠ è½½åœç”¨è¯ï¼Œæ–¹æ³•æ¥è‡ªç»“å·´åˆ†è¯æºç 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadStopWords</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> in<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedReader</span> buff<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            buff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> line<span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>line <span class="token operator">=</span> buff<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                buff<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> set<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 2.å¯¼å…¥ArticleWord
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">importArticleWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// rowä»£è¡¨ç¬¬å‡ è¡Œï¼ŒnewsAmountä»£è¡¨ç°åœ¨æ˜¯ç¬¬å‡ ç¯‡æ–°é—»</span>
        <span class="token keyword">int</span> lineNumber <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> newsID <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// å­˜æ”¾æ ‡é¢˜å’Œå†…å®¹</span>
        <span class="token class-name">String</span> title <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> content<span class="token punctuation">;</span>
        <span class="token comment">// å­˜å‚¨æ¯è¡Œçš„å†…å®¹</span>
        <span class="token class-name">String</span> line <span class="token operator">=</span> bufferReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¼€å§‹è¯»å–æ–°é—»</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>line <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            lineNumber<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">// è¡Œæ•°è‡ªå¢</span>
            <span class="token comment">// å•æ•°è¡Œtitleï¼Œæ”¾åˆ°titleå˜é‡</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>lineNumber <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                title <span class="token operator">=</span> line<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// åŒæ•°è¡Œcontentï¼Œå’Œtitleç»„æˆä¸€ç¯‡æ–°é—»ï¼Œå¼€å§‹å¤„ç†</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>lineNumber <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                content <span class="token operator">=</span> line<span class="token punctuation">;</span>
                <span class="token comment">// æ–°é—»ç¯‡æ•°è‡ªå¢</span>
                newsID<span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token comment">// ç”Ÿæˆå’Œæ‹¼æ¥åç¼€</span>
                suffix <span class="token operator">=</span> <span class="token function">generateSuffix</span><span class="token punctuation">(</span>newsID<span class="token punctuation">,</span> title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// éå†å®Œæ¯1000ç¯‡æ–°é—»ï¼ˆ2000è¡Œï¼‰æ‰§è¡Œä¸€æ¬¡æ’å…¥</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>newsID <span class="token operator">%</span> <span class="token number">1000</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> suffix<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">insertArticleWord</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ’å…¥å®Œ&quot;</span> <span class="token operator">+</span> newsID <span class="token operator">+</span> <span class="token string">&quot;ç¯‡æ–‡ç« ...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// é‡æ–°åˆå§‹åŒ–æ’å…¥è¯­å¥åç¼€</span>
                    suffix <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// è¯»å–ä¸‹ä¸€è¡Œ</span>
            line <span class="token operator">=</span> bufferReader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æœ€åçš„è¿˜å‰©ä¸è¶³1000æ¡ä¹Ÿè¦æ’å…¥</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>suffix<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">insertArticleWord</span><span class="token punctuation">(</span>suffix<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 2.1 ç”Ÿæˆæ’å…¥è¯­å¥åç¼€
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">StringBuilder</span> <span class="token function">generateSuffix</span><span class="token punctuation">(</span><span class="token keyword">int</span> newsID<span class="token punctuation">,</span> <span class="token class-name">String</span> newsTitle<span class="token punctuation">,</span> <span class="token class-name">String</span> newContent<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ–°é—»æ ‡é¢˜å’Œå†…å®¹åˆ†åˆ«åˆ†è¯</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> titleTokenList <span class="token operator">=</span> <span class="token function">separateWords</span><span class="token punctuation">(</span>newsTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> contentTokenList <span class="token operator">=</span> <span class="token function">separateWords</span><span class="token punctuation">(</span>newContent<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¡ç®—æ ‡é¢˜å’Œå†…å®¹è¯æ±‡çš„é¢‘ç‡</span>
        titleFrequencyMap <span class="token operator">=</span> <span class="token function">calculateWordFrequency</span><span class="token punctuation">(</span>stopWordsSet<span class="token punctuation">,</span> titleTokenList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        contentFrequencyMap <span class="token operator">=</span> <span class="token function">calculateWordFrequency</span><span class="token punctuation">(</span>stopWordsSet<span class="token punctuation">,</span> contentTokenList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// éå†å†…å®¹çš„è¯æ±‡-é¢‘ç‡è¡¨</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> contentFrequencyMap<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            suffix<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">buildSqlSuffix</span><span class="token punctuation">(</span>newsID<span class="token punctuation">,</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            titleFrequencyMap<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// éå†æ ‡é¢˜çš„è¯æ±‡-é¢‘ç‡è¡¨</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> titleFrequencyMap<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            suffix<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">buildSqlSuffix</span><span class="token punctuation">(</span>newsID<span class="token punctuation">,</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> suffix<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 2.1.1 åˆ†è¯
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> <span class="token function">separateWords</span><span class="token punctuation">(</span><span class="token class-name">String</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> jiebaSegmenter<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>words<span class="token punctuation">,</span> <span class="token class-name">JiebaSegmenter<span class="token punctuation">.</span>SegMode</span><span class="token punctuation">.</span>SEARCH<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 2.1.2 è®¡ç®—è¯æ±‡åˆ—è¡¨é‡Œæ¯ä¸ªè¯æ±‡å‡ºç°çš„é¢‘ç‡
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token function">calculateWordFrequency</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> stopWordsSet<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SegToken</span><span class="token punctuation">&gt;</span></span> segTokenList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> frequency <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SegToken</span> segToken <span class="token operator">:</span> segTokenList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stopWordsSet<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> segToken<span class="token punctuation">.</span>word<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>frequency<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    frequency<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">,</span> frequency<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    frequency<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>segToken<span class="token punctuation">.</span>word<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> frequency<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 2.1.3 æ„å»ºsqlåç¼€
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">buildSqlSuffix</span><span class="token punctuation">(</span><span class="token keyword">int</span> newsID<span class="token punctuation">,</span> <span class="token class-name">String</span> keyword<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> titleWordFrequency <span class="token operator">=</span> titleFrequencyMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> titleFrequencyMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> contentWordFrequency <span class="token operator">=</span> contentFrequencyMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> contentFrequencyMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>keyword<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> totalWordFrequency <span class="token operator">=</span> titleWordFrequency <span class="token operator">+</span> contentWordFrequency<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> newsID <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> keyword <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> totalWordFrequency <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> titleWordFrequency <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> contentWordFrequency <span class="token operator">+</span> <span class="token string">&quot;),&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">/**
     * 2.2 æ’å…¥ArticleWordåˆ°æ•°æ®åº“
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insertArticleWord</span><span class="token punctuation">(</span><span class="token class-name">StringBuilder</span> sqlSuffix<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> sqlPrefix <span class="token operator">=</span> <span class="token string">&quot;INSERT delayed INTO article_word(article_id, word, freqs, freqs_title, freqs_content) VALUES &quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// substringæ˜¯å› ä¸ºæœ€åä¸€ä¸ª','è¦å»æ‰ values(),(),(), -&gt; values(),(),()</span>
        <span class="token class-name">String</span> sql <span class="token operator">=</span> sqlPrefix <span class="token operator">+</span> sqlSuffix<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> sqlSuffix<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        preparedStatement<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        preparedStatement<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼€å§‹è®¡æ—¶...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆå§‹åŒ–ä¸€äº›å…¨å±€å˜é‡</span>
        <span class="token function">initGlobalVariables</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¯¼å…¥ArticleWord</span>
        <span class="token function">importArticleWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å…³é—­æ•°æ®åº“çš„è¿æ¥</span>
        <span class="token class-name">DatabaseUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> preparedStatement<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡æ—¶ç»“æŸ...æ€»å…±è€—æ—¶&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;æ¯«ç§’&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br></div></div><p>æ–¹æ³•åˆ†ç»„æƒ…å†µï¼š</p> <img src="https://img-blog.csdnimg.cn/73295f36988c44eb8e3fd6fcd7d31552.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"> <img src="https://img-blog.csdnimg.cn/4b9f8846a23c43f1bbb9bc4448ad96c7.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"> <img src="https://img-blog.csdnimg.cn/e4aa3ff15f504a67ad2ddf4431f1d522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"> <h3 id="_8ã€è¿è¡Œæµ‹è¯•"><a href="#_8ã€è¿è¡Œæµ‹è¯•" class="header-anchor">#</a> 8ã€è¿è¡Œæµ‹è¯•</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>å¼€å§‹è®¡æ—¶...main dict load finished, time elapsed 918 msmodel load finished, time elapsed 119 ms.æ’å…¥å®Œ1000ç¯‡æ–‡ç« ...æ’å…¥å®Œ2000ç¯‡æ–‡ç« ...æ’å…¥å®Œ3000ç¯‡æ–‡ç« ......æ’å…¥å®Œ1297000ç¯‡æ–‡ç« ...æ’å…¥å®Œ1298000ç¯‡æ–‡ç« ...è®¡æ—¶ç»“æŸ...æ€»å…±è€—æ—¶880752æ¯«ç§’
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ€»å…±è€—æ—¶14åˆ†41ç§’ï¼Œé˜”ä»¥é˜”ä»¥~ å¦‚æœç”¨ <code>prepareStatement</code> çš„å ä½ç¬¦ <code>?</code> æ–¹å¼å¯èƒ½å°±ä¸æ­¢è¿™ä¹ˆä¹…äº†</p> <img src="https://img-blog.csdnimg.cn/250484d1633843999d8173b622a4ed36.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> article_word<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç»“æœï¼š<code>118893080</code>æ¡æ•°æ®</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token operator">&gt;</span> <span class="token number">118893080</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_3ã€newsdemowebå®è·µ"><a href="#_3ã€newsdemowebå®è·µ" class="header-anchor">#</a> 3ã€<code>NewsDemoWeb</code>å®è·µ</h2> <h3 id="_1ã€åŸºäºå…¨æ–‡ç´¢å¼•çš„æŸ¥è¯¢"><a href="#_1ã€åŸºäºå…¨æ–‡ç´¢å¼•çš„æŸ¥è¯¢" class="header-anchor">#</a> 1ã€åŸºäºå…¨æ–‡ç´¢å¼•çš„æŸ¥è¯¢</h3> <p>åœ¨ <code>ArticleDao</code> ä¸‹æ–°å»ºä¸€ä¸ªå…¨æ–‡ç´¢å¼•æŸ¥è¯¢çš„æ–¹æ³•ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * åŸºäºå…¨æ–‡ç´¢å¼•çš„æŸ¥è¯¢
 *
 * @param word å…³é”®è¯
 * @return æŸ¥è¯¢ç»“æœ
 */</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArticleVo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getListByWordWithFulltext</span><span class="token punctuation">(</span><span class="token class-name">String</span> word<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;SELECT * FROM article WHERE MATCH (title, content) AGAINST ('&quot;</span> <span class="token operator">+</span> word <span class="token operator">+</span><span class="token string">&quot;')&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">selectList</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>åœ¨ <code>ArticleDaoTest</code> ä¸‹æ–°å»ºä¸€ä¸ªæµ‹è¯•å…¨æ–‡ç´¢å¼•æŸ¥è¯¢çš„æ–¹æ³•ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * æµ‹è¯•å…¨æ–‡ç´¢å¼•æŸ¥è¯¢
 */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGetListByWordWithFulltext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">ArticleDao</span> articleDao <span class="token operator">=</span> <span class="token class-name">ArticleDao</span><span class="token punctuation">.</span><span class="token function">getArticleDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>articleDao<span class="token punctuation">.</span><span class="token function">getListByWordWithFulltext</span><span class="token punctuation">(</span><span class="token string">&quot;æ²³æº&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è¿è¡Œç»“æœï¼š</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>587
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åœ¨ <code>servlet</code> åŒ…ä¸‹æ–°å»ºä¸€ä¸ª <code>ArticleFulltextServlet</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">ArticleDao</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">GsonUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">ArticleVo</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span></span><span class="token class-name">Gson</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/article-fulltext&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArticleFulltextServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token function">doPost</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/json;charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> word <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;word&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Gson</span> gson <span class="token operator">=</span> <span class="token class-name">GsonUtil</span><span class="token punctuation">.</span><span class="token function">getGson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArticleDao</span> articleDao <span class="token operator">=</span> <span class="token class-name">ArticleDao</span><span class="token punctuation">.</span><span class="token function">getArticleDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrintWriter</span> out <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArticleVo</span><span class="token punctuation">&gt;</span></span> articleListByWord <span class="token operator">=</span> articleDao<span class="token punctuation">.</span><span class="token function">getListByWordWithFulltext</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
            out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>articleListByWord<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>ä»£ç æ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬å°±æ˜¯å¤åˆ¶ç²˜è´´ï¼Œæ”¹å‡ ä¸ªåœ°æ–¹</p> <p>å¯åŠ¨æœåŠ¡å™¨ï¼Œæµ‹è¯•</p> <p><img src="https://img-blog.csdnimg.cn/41daec80f36e419699cce9409d63923c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <h3 id="_2ã€è‡ªå®šä¹‰åˆ†è¯æŸ¥è¯¢"><a href="#_2ã€è‡ªå®šä¹‰åˆ†è¯æŸ¥è¯¢" class="header-anchor">#</a> 2ã€è‡ªå®šä¹‰åˆ†è¯æŸ¥è¯¢</h3> <p>é¦–å…ˆ <code>article_word</code> è¡¨å·²ç»å»ºå¥½äº†ï¼Œæ¥ä¸‹æ¥è¦åˆ†ææ€ä¹ˆæŸ¥ï¼Œç„¶åæ ¹æ®æ€ä¹ˆæŸ¥æ¥æ–°å»ºç´¢å¼•ï¼Œæé«˜æŸ¥è¯¢é€Ÿåº¦~</p> <p>åˆ†æï¼šç”¨æˆ·è¾“å…¥å…³é”®è¯-&gt;æ ¹æ®å…³é”®è¯åœ¨ <code>article_word</code> æŸ¥è¯¢å‡ºæ–°é—» <code>id</code> -&gt;æ ¹æ®æ–°é—» <code>id</code> å› <code>article</code> è¡¨æŸ¥è¯¢æ–°é—»çš„è¯¦ç»†ä¿¡æ¯</p> <p>æ ¹æ®<strong>ç´¢å¼•è¦†ç›–æŸ¥è¯¢åˆ—å’Œwhereæ¡ä»¶é‡Œçš„å­—æ®µ</strong>çš„åŸåˆ™ï¼Œæˆ‘ä»¬è¿™æ ·è®¾è®¡ä¸€ä¸ªæ™®é€šç´¢å¼•å³å¯ï¼Œå¯¹ <code>word</code>, <code>article_id</code> å»ºç«‹è”åˆç´¢å¼•ï¼Œä¸ºä»€ä¹ˆ <code>word</code> æ”¾åœ¨ <code>article_id</code> å‰ï¼Œå½“ç„¶æ˜¯æ ¹æ®ç´¢å¼•çš„æœ€å·¦åŒ¹é…åŸåˆ™ï¼Œå…·ä½“ä¸æ‡‚çš„å¯ä»¥æŸ¥æŸ¥èµ„æ–™</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">index</span> word_id <span class="token keyword">on</span> article_word<span class="token punctuation">(</span>word<span class="token punctuation">,</span> article_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç„¶åç­‰ä¸ª4000å¤šç§’å°±å»ºå¥½äº†</p> <p>æ¥ä¸‹æ¥è¯•è¯•æ•ˆæœ~</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> article_id <span class="token keyword">from</span> article_word <span class="token keyword">where</span> word <span class="token operator">=</span> <span class="token string">'å¸…å“¥'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/b50d7ae635834027b7ed251aaa817b39.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>ç„¶åå†åˆ†ææ€ä¹ˆå› <code>article</code> è¡¨æŸ¥ï¼Œå…¶å®ä¹ŸæŒºç®€å•ï¼Œå°±æ˜¯æ ¹æ® <code>article_id</code> å’Œ <code>article</code> è¡¨çš„ <code>id</code> æ˜¯ä¸€æ ·çš„å³å¯ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨èŒƒå›´æŸ¥è¯¢inï¼Œå½“ç„¶äº†ï¼Œä¸ºäº†æé«˜é€Ÿåº¦ï¼Œæˆ‘ä»¬åšä¸€ä¸‹åˆ†é¡µ</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> article <span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span>
	<span class="token keyword">select</span> article_id <span class="token keyword">from</span> article_word <span class="token keyword">where</span> word <span class="token operator">=</span> <span class="token string">'å¸…å“¥'</span>
<span class="token punctuation">)</span> <span class="token keyword">limit</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://img-blog.csdnimg.cn/65dba34e8fba46aa9ff7126b48a18e11.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>è¿˜æ˜¯æŒºå¿«çš„~</p> <p>OKï¼Œç»“æœæŸ¥å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æŠŠå®ƒæ•´åˆåˆ°åç«¯é‡Œé¢äº†</p> <p>åœ¨ <code>ArticleDao</code> ä¸‹æ–°å»ºä¸€ä¸ªæ–¹æ³•ï¼Œç„¶åæŠŠè¯­å¥æ”¹é€ ä¸€ä¸‹å³å¯</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
  * åŸºäºå…¨æ–‡ç´¢å¼•çš„æŸ¥è¯¢
  *
  * @param word å…³é”®è¯
  * @param pageNumber é¡µç 
  * @param pageSize é¡µå¤§å°
  * @return è‡ªå®šä¹‰åˆ†è¯æŸ¥è¯¢ç»“æœ
  */</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArticleVo</span><span class="token punctuation">&gt;</span></span> <span class="token function">getListByWordCustom</span><span class="token punctuation">(</span><span class="token class-name">String</span> word<span class="token punctuation">,</span> <span class="token keyword">int</span> pageNumber<span class="token punctuation">,</span> <span class="token keyword">int</span> pageSize<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;select * from article where id in (&quot;</span> <span class="token operator">+</span>
    <span class="token string">&quot;select article_id from article_word where word = '&quot;</span> <span class="token operator">+</span> word <span class="token operator">+</span> <span class="token string">&quot;') &quot;</span> <span class="token operator">+</span>
    <span class="token string">&quot;limit &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pageNumber <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> pageSize<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> pageSize<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">selectList</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>åœ¨ <code>ArticleDaoTest</code> ç¼–å†™æµ‹è¯•æ–¹æ³•</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
  * æµ‹è¯•è‡ªå®šä¹‰åˆ†è¯æŸ¥è¯¢
  */</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testGetListByWordCustom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token class-name">ArticleDao</span> articleDao <span class="token operator">=</span> <span class="token class-name">ArticleDao</span><span class="token punctuation">.</span><span class="token function">getArticleDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>articleDao<span class="token punctuation">.</span><span class="token function">getListByWordCustom</span><span class="token punctuation">(</span><span class="token string">&quot;æ²³æº&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>è¿è¡Œç»“æœæ¯”è¾ƒå¤šï¼Œè¿™é‡Œå°±ä¸å±•ç¤ºäº†</p> <p><code>servlet</code> åŒ…ä¸‹æ–°å»º <code>ArticleCustomServlet</code>ï¼Œè¿˜æ˜¯åŸºæœ¬å¥—è·¯</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>servlet</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">ArticleDao</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">GsonUtil</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">ArticleVo</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>gson<span class="token punctuation">.</span></span><span class="token class-name">Gson</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@WebServlet</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/article-custom&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArticleCustomServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token function">doPost</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/json;charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> word <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;word&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> pageNumber <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;pageNumber&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> pageSize <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;pageSize&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Gson</span> gson <span class="token operator">=</span> <span class="token class-name">GsonUtil</span><span class="token punctuation">.</span><span class="token function">getGson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArticleDao</span> articleDao <span class="token operator">=</span> <span class="token class-name">ArticleDao</span><span class="token punctuation">.</span><span class="token function">getArticleDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrintWriter</span> out <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArticleVo</span><span class="token punctuation">&gt;</span></span> articleListByWord <span class="token operator">=</span> articleDao<span class="token punctuation">.</span><span class="token function">getListByWordCustom</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> pageNumber<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
            out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>articleListByWord<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>å¯åŠ¨æœåŠ¡å™¨ï¼Œè¿è¡Œç»“æœï¼š</p> <p><img src="https://img-blog.csdnimg.cn/f763f22895bb4e6ab55411ec88e63a42.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <h3 id="_3ã€ç¼“å­˜"><a href="#_3ã€ç¼“å­˜" class="header-anchor">#</a> 3ã€ç¼“å­˜</h3> <p>æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨ <code>LRU</code> ç¼“å­˜ï¼Œé‡‡ç”¨æ³›å‹ä½¿å®ƒæ›´å…·é€šç”¨æ€§</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * LRU (æœ€è¿‘æœ€å°‘ä½¿ç”¨) ç¼“å­˜
 * æ”¯æŒä»¥ä¸‹æ“ä½œï¼š è·å–æ•°æ® get å’Œ å†™å…¥æ•°æ® put
 *
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LruCache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">LinkedNode</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> capacity<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> head<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> tail<span class="token punctuation">;</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token class-name">LruCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>capacity <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tail <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    head<span class="token punctuation">.</span>next <span class="token operator">=</span> tail<span class="token punctuation">;</span>
    tail<span class="token punctuation">.</span>pre <span class="token operator">=</span> head<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
    * ç§»é™¤èŠ‚ç‚¹
    *
    * @param node èŠ‚ç‚¹
    */</span>
  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">removeNode</span><span class="token punctuation">(</span><span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> preNode <span class="token operator">=</span> node<span class="token punctuation">.</span>pre<span class="token punctuation">;</span>
    <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> nextNode <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
    preNode<span class="token punctuation">.</span>next <span class="token operator">=</span> nextNode<span class="token punctuation">;</span>
    nextNode<span class="token punctuation">.</span>pre <span class="token operator">=</span> preNode
  <span class="token punctuation">}</span>

  <span class="token comment">/**
    * æ·»åŠ èŠ‚ç‚¹åˆ°å¤´éƒ¨
    *
    * @param node èŠ‚ç‚¹
    */</span>
  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addNode</span><span class="token punctuation">(</span><span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    node<span class="token punctuation">.</span>pre <span class="token operator">=</span> head<span class="token punctuation">;</span>
    node<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
    head<span class="token punctuation">.</span>next<span class="token punctuation">.</span>pre <span class="token operator">=</span> node<span class="token punctuation">;</span>
    head<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
    * å°†èŠ‚ç‚¹ç§»åŠ¨åˆ°å¤´éƒ¨
    *
    * @param node èŠ‚ç‚¹
    */</span>
  <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">moveToHead</span><span class="token punctuation">(</span><span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">removeNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">addNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
    * è·å–æ•°æ®
    *
    * @param key é”®
    * @return é”®å¯¹åº”çš„æ•°æ®
    */</span>
  <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">moveToHead</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> node<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
    * å†™å…¥æ•°æ®
    *
    * @param key   é”®
    * @param value æ•°æ®
    */</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> node <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//å­˜åœ¨</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      node<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token function">moveToHead</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//ä¸å­˜åœ¨</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> newNode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      newNode<span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
      newNode<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
      cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> newNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">addNode</span><span class="token punctuation">(</span>newNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//æ›´æ–°ç»“ç‚¹æ•°</span>
      size<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">&gt;</span> capacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> tailPre <span class="token operator">=</span> tail<span class="token punctuation">.</span>pre<span class="token punctuation">;</span>
        cache<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>tailPre<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">removeNode</span><span class="token punctuation">(</span>tailPre<span class="token punctuation">)</span><span class="token punctuation">;</span>
        size<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> key<span class="token punctuation">;</span>
    <span class="token class-name">T</span> value<span class="token punctuation">;</span>
    <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> pre<span class="token punctuation">;</span>
    <span class="token class-name">LinkedNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> next<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br></div></div><p>ç„¶ååœ¨ <code>ArticleCustomServlet</code> ä¸­è¯•è¯•æ°´~</p> <p>æŠŠç¼“å­˜æ·»åŠ åˆ°æˆå‘˜å˜é‡å¹¶åˆå§‹åŒ–</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">LruCache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ArticleVo</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LruCache</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç„¶åç¨å¾®æŠŠé€»è¾‘æ”¹ä¸€æ”¹</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// æŸ¥è¯¢å‘½ä¸­ç¼“å­˜</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¾“å‡ºç¼“å­˜å¥½çš„æŸ¥è¯¢ç»“æœ</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// æŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åæ·»åŠ åˆ°ç¼“å­˜</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
  response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/json;charset=utf8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">String</span> word <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;word&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> pageNumber <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;pageNumber&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> pageSize <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getParameter</span><span class="token punctuation">(</span><span class="token string">&quot;pageSize&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Gson</span> gson <span class="token operator">=</span> <span class="token class-name">GsonUtil</span><span class="token punctuation">.</span><span class="token function">getGson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">PrintWriter</span> out <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;èµ°ç¼“å­˜...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token class-name">ArticleDao</span> articleDao <span class="token operator">=</span> <span class="token class-name">ArticleDao</span><span class="token punctuation">.</span><span class="token function">getArticleDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArticleVo</span><span class="token punctuation">&gt;</span></span> articleListByWord <span class="token operator">=</span> articleDao<span class="token punctuation">.</span><span class="token function">getListByWordCustom</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> pageNumber<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
      cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> articleListByWord<span class="token punctuation">)</span><span class="token punctuation">;</span>
      out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>articleListByWord<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>ç¬¬ä¸€æ¬¡åˆ·æ–°æµè§ˆå™¨æ²¡æ‰“å°ï¼Œç¬¬äºŒæ¬¡åˆ·æ–°å°±æ‰“å°å‡ºäº†èµ°ç¼“å­˜</p> <p>å½“ç„¶ï¼Œè¿™é‡Œè¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚é¡µç å’Œé¡µçš„å¤§å°å˜äº†ï¼ŒæŸ¥è¯¢ç›¸åŒçš„å…³é”®è¯å³ä½¿å’Œç¼“å­˜ä¸€æ ·ä¹Ÿè¦é‡æ–°æŸ¥æ•°æ®åº“å’Œæ›´æ–°ç¼“å­˜ï¼Œå½“ç„¶ï¼Œè¿™ä¸€æ­¥äº¤ç»™ä½ ä»¬ä¼˜åŒ–ï¼Œåœ¨è¿™é‡Œæˆ‘æå‡ºä¸€ç§è§£å†³æ–¹æ³•ï¼Œæ¯”è¾ƒå·§å¦™</p> <p>å°±æ˜¯æŠŠ <code>word + pageNumber + pageSize</code> æ‹¼æ¥èµ·æ¥è”åˆä½œä¸ºé”®ï¼Œè¿™æ ·åªè¦å…¶ä¸­ä»»ä½•ä¸€ä¸ªå˜åŒ–äº†ï¼Œéƒ½ä¸ä¼šèµ°ç¼“å­˜ï¼Œè‚¿ä¹ˆæ ·ï¼Œç³»ä¸ç³»æŒºå·§å¦™æ»´~</p> <img src="https://img-blog.csdnimg.cn/6f06132261fb491ba2b3686524f4c754.gif" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:80%;"> <p>ä½†æ˜¯ï¼Œæˆ‘å‘Šè¯‰ä½ ä»¬ï¼Œåˆ«é«˜å…´å¾—å¤ªæ—©äº†ï¼Œå“ˆå“ˆå“ˆï¼Œå…¶å®è¿™æ ·åšæœ‰ä¸ª<code>bug</code>ï¼Œå°±æ˜¯å¦‚æœæˆ‘çš„ <code>pageNumber</code> å’Œ <code>pageSize</code> åˆ†åˆ«æ˜¯<code>(1, 23)</code>å’Œ<code>(12, 3)</code>ï¼Œé‚£æ‹¼æ¥ä¸æ˜¯ç»“æœä¸€æ ·å—ï¼Ÿæ‰€ä»¥æˆ‘ä»¬è¿˜è¦å†æ”¹è¿›ä¸€ä¸‹ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨å®ƒä»¬çš„ä¸­é—´åŠ ä¸Šä¸€ä¸ªå­—ç¬¦å°±è¡Œ~</p> <p>æ”¹è¿›å‰ï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">if</span><span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>word <span class="token operator">+</span> pageNumber <span class="token operator">+</span> pageSize<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;èµ°ç¼“å­˜...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>word <span class="token operator">+</span> pageNumber <span class="token operator">+</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token class-name">ArticleDao</span> articleDao <span class="token operator">=</span> <span class="token class-name">ArticleDao</span><span class="token punctuation">.</span><span class="token function">getArticleDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArticleVo</span><span class="token punctuation">&gt;</span></span> articleListByWord <span class="token operator">=</span> articleDao<span class="token punctuation">.</span><span class="token function">getListByWordCustom</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> pageNumber<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>word <span class="token operator">+</span> pageNumber <span class="token operator">+</span> pageSize<span class="token punctuation">,</span> articleListByWord<span class="token punctuation">)</span><span class="token punctuation">;</span>
        out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>articleListByWord<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>æ”¹è¿›åï¼š</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> cacheKey <span class="token operator">=</span> word <span class="token operator">+</span> <span class="token string">&quot;@&quot;</span> <span class="token operator">+</span> pageNumber <span class="token operator">+</span> <span class="token string">&quot;@&quot;</span> <span class="token operator">+</span>pageSize<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;èµ°ç¼“å­˜...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token class-name">ArticleDao</span> articleDao <span class="token operator">=</span> <span class="token class-name">ArticleDao</span><span class="token punctuation">.</span><span class="token function">getArticleDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ArticleVo</span><span class="token punctuation">&gt;</span></span> articleListByWord <span class="token operator">=</span> articleDao<span class="token punctuation">.</span><span class="token function">getListByWordCustom</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> pageNumber<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>cacheKey<span class="token punctuation">,</span> articleListByWord<span class="token punctuation">)</span><span class="token punctuation">;</span>
        out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>gson<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span>articleListByWord<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        out<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>æµ‹è¯•ï¼š</p> <p>http://localhost:8080/demo/article-custom?word=%E6%B2%B3%E6%BA%90&amp;pageNumber=12&amp;pageSize=3</p> <p>http://localhost:8080/demo/article-custom?word=%E6%B2%B3%E6%BA%90&amp;pageNumber=1&amp;pageSize=23</p> <p><img src="https://img-blog.csdnimg.cn/0e8647633ab344c8911376d1dbeafee8.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"> <img src="https://img-blog.csdnimg.cn/33af99e958434ea2a04142f24fb005e6.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NDkxNTQ5,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> <p>å¯è§ï¼Œæ•ˆæœæ æ æ»´~</p> <h2 id="_4ã€æ€»ç»“"><a href="#_4ã€æ€»ç»“" class="header-anchor">#</a> 4ã€æ€»ç»“</h2> <p>å…¶å®åœ¨æ­¤åç«¯é¡¹ç›®ä¸­å­˜åœ¨å¾ˆå¤šå€¼å¾—ä¼˜åŒ–çš„åœ°æ–¹ï¼Œæ¯”å¦‚è§£å†³å†—ä½™ä»£ç ï¼Œå®Œå–„è¾¹ç•Œæƒ…å†µåˆ¤æ–­ç­‰ï¼Œä¸è¿‡æˆ‘åªæ˜¯å¸®ä½ ä»¬æŠŠä¸»è¦ä¸šåŠ¡é€»è¾‘ç†æ¸…æ¥šï¼Œå…¶ä»–çš„è¯·è‡ªè¡Œå‘æŒ¥äº†~</p> <p>å‰ç«¯éƒ¨åˆ†æˆ‘ä»¬ä¼šåœ¨ç¬¬å››è®²è®²å®Œåå†ç»Ÿä¸€å¼€å‘ï¼Œä¸è¦æ€¥å“ˆ~</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/nomoe/assets/js/app.b0634cdc.js" defer></script><script src="/nomoe/assets/js/2.e531c252.js" defer></script><script src="/nomoe/assets/js/17.da74545f.js" defer></script>
  </body>
</html>
